(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{780:function(t,e,n){"use strict";n.r(e);n(25),n(8),n(67);var o=n(30),r=(n(75),n(4),n(2),n(77),n(106),n(135),n(76),n(182),n(6),n(43),{data:function(){return{articles:[],ticket:[],searchQuery:"",clientField:{field:"selectedContact",sourceApi:"Contact/GetFilter",sourceLabel:"name",formSoportId:"1534f256-6c42-41ea-860b-ae8f69206865"},perPage:10,pageOptions:[5,10,25,50,100],selectedContact:null,discount:0,currentPage:1,fields:[{key:"priceSale",label:""},{key:"Acciones",label:""}],showModal:!1,form:{denominations:[{id:null,name:"2000",value:2e3,quantity:0,total:0},{id:null,name:"1000",value:1e3,quantity:0,total:0},{id:null,name:"500",value:500,quantity:0,total:0},{id:null,name:"100",value:100,quantity:0,total:0},{id:null,name:"50",value:50,quantity:0,total:0},{id:null,name:"25",value:25,quantity:0,total:0},{id:null,name:"10",value:10,quantity:0,total:0},{id:null,name:"5",value:5,quantity:0,total:0},{id:null,name:"1",value:1,quantity:0,total:0}]},paymentMethods:[{name:"Cash"},{name:"Credit"},{name:"Debit"},{name:"Gift Card"}],totalToSubtract:0,amountReceived:0}},computed:{filteredArticles:function(){var t=this,e=this.articles.filter((function(e){return e.description.toLowerCase().includes(t.searchQuery.toLowerCase())}));if(!isNaN(parseFloat(this.searchQuery))&&isFinite(this.searchQuery)){var n=parseFloat(this.searchQuery);e=e.filter((function(t){return t.priceSale===n}))}return e},total:function(){return this.ticket.reduce((function(t,e){return t+e.price*e.quantity}),0)},totalWithDiscount:function(){var t=this.total;return(t-this.discount/100*t).toFixed(2)},totalRows:function(){return this.filteredArticles.length},change:function(){return(this.amountReceived-this.totalWithDiscount).toFixed(2)}},watch:{perPage:function(){this.currentPage=1}},mounted:function(){this.fetchArticles()},methods:{GetLitValue:function(t,e){console.log("GetLitValue",e),this.selectedContact=e},fetchArticles:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/Concept/GetAll");case 3:n=e.sent,t.articles=n.data.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching articles:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},addItemToTicket:function(t){var e=this.ticket.find((function(e){return e.id===t.id}));e?e.quantity++:this.ticket.push({id:t.id,description:t.description,price:t.priceSale,quantity:1}),this.updateTotal()},removeItem:function(t){this.ticket.splice(t,1),this.updateTotal()},updateTotal:function(){this.total=this.ticket.reduce((function(t,e){return t+e.price*e.quantity}),0).toFixed(2)},printTicket:function(){var t=window.open("","PRINT","height=600,width=800");t.document.write("<html><head><title>Ticket</title>"),t.document.write("<style>body { font-family: monospace; }</style>"),t.document.write("</head><body>"),t.document.write("<h2>Ticket de Compra</h2>"),t.document.write("<p>Cliente: "+(this.selectedContact?this.selectedContact.name:"No seleccionado")+"</p>"),t.document.write("<hr>"),this.ticket.forEach((function(e){t.document.write("<p>"+e.description+" - "+e.quantity+" x $"+e.price+"</p>")})),t.document.write("<hr>"),t.document.write("<p>Descuento: "+this.discount+"%</p>"),t.document.write("<p>Total: $"+this.totalWithDiscount+"</p>"),t.document.write("</body></html>"),t.document.close(),t.focus(),setTimeout((function(){t.print(),t.close()}),1e3)},addDenomination:function(t){var e=parseFloat(this.amountReceived)+parseFloat(t);isNaN(e)||(this.amountReceived=e.toFixed(2))},addRow:function(){this.form.denominations.push({id:null,name:"",value:0,quantity:0,total:0})},removeRow:function(t){this.form.denominations.splice(t,1),this.calculateTotal()},calculateTotal:function(){var t=this;this.totalToSubtract=0,this.form.denominations.forEach((function(e){e.total=e.value*e.quantity,t.totalToSubtract+=e.total}))}}}),c=n(17),component=Object(c.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[t._v("Ticket")]),t._v(" "),e("div",{staticClass:"card-body"},[e("div",[t._v("\n            Cliente:\n            "),e("vSelectContact",{attrs:{field:t.clientField},on:{CustomChange:t.GetLitValue}}),t._v(" "),t.selectedContact?e("span",[t._v(t._s(t.selectedContact.name))]):t._e()],1),t._v(" "),e("div",{staticClass:"table-responsive",staticStyle:{"max-height":"600px","overflow-y":"auto"}},[e("table",{staticClass:"table table-sm table-striped"},[t._m(0),t._v(" "),e("tbody",t._l(t.ticket,(function(n,o){return e("tr",{key:o},[e("td",{staticStyle:{width:"85%","text-align":"left"}},[t._v(t._s(n.description))]),t._v(" "),e("td",{staticStyle:{width:"5%","text-align":"right"}},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:n.quantity,expression:"ticketItem.quantity",modifiers:{number:!0}}],staticClass:"form-control form-control-sm",attrs:{type:"number",min:"1"},domProps:{value:n.quantity},on:{input:[function(e){e.target.composing||t.$set(n,"quantity",t._n(e.target.value))},t.updateTotal],blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),e("td",{staticStyle:{width:"5%","text-align":"right"}},[t._v("$ "+t._s(n.price))]),t._v(" "),e("td",{staticStyle:{width:"5%","text-align":"right"}},[e("button",{staticClass:"btn btn-sm btn-danger",on:{click:function(e){return t.removeItem(o)}}},[t._v("-")])])])})),0)])]),t._v(" "),e("div",{staticClass:"mt-2"},[e("label",{attrs:{for:"discount"}},[t._v("Descuento:")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.discount,expression:"discount",modifiers:{number:!0}}],staticClass:"form-control form-control-sm",attrs:{type:"number",id:"discount",min:"0"},domProps:{value:t.discount},on:{input:[function(e){e.target.composing||(t.discount=t._n(e.target.value))},t.updateTotal],blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),e("p",{staticClass:"mt-2"},[e("b",[t._v("Total: $"+t._s(t.totalWithDiscount))])]),t._v(" "),e("button",{staticClass:"btn btn-success mt-2",on:{click:function(e){t.showModal=!0}}},[t._v("Pagar")])])])]),t._v(" "),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[t._v("Artículos")]),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"form-control form-control-sm",attrs:{type:"text",placeholder:"Buscar artículo..."},domProps:{value:t.searchQuery},on:{input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"table-responsive",staticStyle:{"max-height":"600px","overflow-y":"auto"}},[e("b-table",{attrs:{striped:"",hover:"",items:t.filteredArticles,"per-page":t.perPage,"current-page":t.currentPage,fields:t.fields,responsive:"sm"},scopedSlots:t._u([{key:"cell(priceSale)",fn:function(data){return[e("button",{staticClass:"btn btn-lg btn-primary w-100",on:{click:function(e){return t.addItemToTicket(data.item)}}},[e("div",{staticClass:"alert alert-success",attrs:{role:"alert"}},[t._v("\n                    "+t._s(data.item.description)+"\n                  ")]),t._v(" "),e("div",{staticClass:"alert alert-info",attrs:{role:"alert"}},[t._v("\n                    $"+t._s(data.value)+"\n                  ")])])]}}])})],1),t._v(" "),e("b-pagination",{attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)])])]),t._v(" "),e("b-modal",{attrs:{title:"Pagos","hide-footer":"",size:"xl"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("table",{staticClass:"table striped table-border"},[e("thead",{staticClass:"bg-Cprimary"},[e("tr",[e("th",{staticStyle:{width:"20%"}},[t._v("Denominación")]),t._v(" "),e("th",{staticStyle:{width:"20%"}},[t._v("Cantidad")]),t._v(" "),e("th",{staticStyle:{width:"20%"}},[t._v("Total")])])]),t._v(" "),e("tbody",t._l(t.form.denominations,(function(n,o){return e("tr",{key:o},[e("td",[t._v(t._s(n.name))]),t._v(" "),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:n.quantity,expression:"denomination.quantity"}],attrs:{type:"number"},domProps:{value:n.quantity},on:{input:[function(e){e.target.composing||t.$set(n,"quantity",e.target.value)},t.calculateTotal]}})]),t._v(" "),e("td",[t._v("$"+t._s(n.total))])])})),0)])]),t._v(" "),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[t._v("Métodos de Pago")]),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"list-group"},t._l(t.paymentMethods,(function(n){return e("button",{key:n.name,staticClass:"list-group-item list-group-item-action",attrs:{type:"button"},on:{click:function(e){return t.addDenomination(t.totalWithDiscount)}}},[t._v("\n                "+t._s(n.name)+"\n              ")])})),0)])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[t._v("RESUMEN DE PAGO")]),t._v(" "),e("div",{staticClass:"card-body"},[e("p",[t._v("Total a pagar: $"+t._s(t.totalWithDiscount))]),t._v(" "),e("p",[t._v("Total recibido: $"+t._s(t.totalToSubtract))]),t._v(" "),t.totalToSubtract>t.totalWithDiscount?e("p"):t._e(),e("div",{staticClass:"alert alert-warning",attrs:{role:"alert"}},[t._v("\n              Devuelta:$"+t._s(t.totalWithDiscount-t.totalToSubtract))]),t._v(" "),e("p"),t._v(" "),t.totalWithDiscount<t.totalToSubtract?e("p"):t._e(),e("div",{staticClass:"alert alert-warning",attrs:{role:"alert"}},[t._v("\n              Pendiente a pagar:$"+t._s(t.totalWithDiscount-t.totalToSubtract)+"\n            ")]),t._v(" "),e("p"),t._v(" "),e("button",{staticClass:"btn btn-primary mt-2",on:{click:t.printTicket}},[t._v("Imprimir Ticket")])])])])])])],1)}),[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{staticStyle:{width:"85%","text-align":"left"}},[t._v("Descripción")]),t._v(" "),e("th",{staticStyle:{width:"5%","text-align":"right"}},[t._v("Cantidad")]),t._v(" "),e("th",{staticStyle:{width:"5%","text-align":"right"}},[t._v("Precio")]),t._v(" "),e("th",{staticStyle:{width:"5%","text-align":"right"}},[t._v("Acciones")])])])}],!1,null,null,null);e.default=component.exports}}]);